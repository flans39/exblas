#
# Makefile.LINUX
#
#
# If you compile, change the name to Makefile.in.
#
#
VERSION	= 0.3.2b
 
#-----------------------------------------------------------------------------
# Shell
#-----------------------------------------------------------------------------

SHELL	= /bin/sh

#-----------------------------------------------------------------------------
# Platform
#-----------------------------------------------------------------------------

PLAT	= LINUX

#-----------------------------------------------------------------------------
# Libraries and includs
#-----------------------------------------------------------------------------
 
BLLIB	= /usr/lib/atlas/libblas.a
CBLIB	= ../lib/cblas_$(PLAT).a
OPENCLSDKROOT	= /opt/AMDAPP
#OPENCLSDKROOT	= /usr/local/cuda
OCLBLASLIBNAME	= liboclblas.a
OCLBLASLIB	?= $(OCLBLASROOT)/lib/$(OCLBLASLIBNAME)

#-----------------------------------------------------------------------------
# Compilers
#-----------------------------------------------------------------------------

CC	= gcc
CXX	= g++
FC	= gfortran
LOADER	= $(FC)

#-----------------------------------------------------------------------------
# Flags for Compilers
#-----------------------------------------------------------------------------

CFLAGS	= -O3 -DADD_ -I$(OPENCLSDKROOT)/include -I$(OCLBLASROOT)/include -I.
CXXFLAGS	= -O3 -DADD_ -I$(OPENCLSDKROOT)/include -I$(OCLBLASROOT)/include -I.
FFLAGS	= -O3  
LDFLAGS	= -L$(OPENCLSDKROOT)/lib -L$(OCLBLASROOT)/lib -loclblas -lOpenCL -lc

#-----------------------------------------------------------------------------
# Archive programs and flags
#-----------------------------------------------------------------------------

ARCH	= ar
ARCHFLAGS	= cr
RANLIB	= ranlib

#-----------------------------------------------------------------------------
# Others
#-----------------------------------------------------------------------------
RM	= rm -f
TARGET_PLATFORM_IDX ?= 0
TARGET_DEVICE       ?= GPU

ifeq ($(TARGET_PLATFORM_IDX), 0)
	CXXFLAGS += -DTARGET_OPENCL_PLATFORM_IDX=0
else ifeq ($(TARGET_PLATFORM_IDX), 1)
	CXXFLAGS += -DTARGET_OPENCL_PLATFORM_IDX=1
else ifeq ($(TARGET_PLATFORM_IDX), 2)
	CXXFLAGS += -DTARGET_OPENCL_PLATFORM_IDX=2
else ifeq ($(TARGET_PLATFORM_IDX), 3)
	CXXFLAGS += -DTARGET_OPENCL_PLATFORM_IDX=3
endif

ifeq ($(TARGET_DEVICE), GPU)
	CXXFLAGS += -DTARGET_OPENCL_DEVICE_GPU
else ifeq ($(TARGET_DEVICE), CPU)
	CXXFLAGS += -DTARGET_OPENCL_DEVICE_CPU
else ifeq ($(TARGET_DEVICE), ACCELERATOR)
	CXXFLAGS += -DTARGET_OPENCL_DEVICE_ACCELERATOR
endif
